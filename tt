                if (ns.getResourceQuotas() != null) {
                    values.append("    resourceQuota:\n");
                    var quota = ns.getResourceQuotas();

                    if (quota.getPods() != null) {
                        values.append("      pods: ").append(quota.getPods()).append("\n");
                    }
                    if (quota.getRequests() != null && !quota.getRequests().isEmpty()) {
                        values.append("      requests:\n");
                        quota.getRequests().forEach(
                                (k, v) -> values.append("        ").append(k).append(": ").append(v).append("\n"));
                    }
                    if (quota.getLimits() != null && !quota.getLimits().isEmpty()) {
                        values.append("      limits:\n");
                        quota.getLimits().forEach(
                                (k, v) -> values.append("        ").append(k).append(": ").append(v).append("\n"));
                    }
                }


 @Test
        @DisplayName("Should include resource quotas in Helm values")
        void testResourceQuotaSerialization() {
            // Given
            TestFlight tf = createTestFlight("quota-test", "alpha");
            com.example.testflight.crd.QuotaConfig quota = new com.example.testflight.crd.QuotaConfig();
            quota.setPods("10");
            quota.setRequests(Map.of("cpu", "1", "memory", "1Gi"));
            quota.setLimits(Map.of("cpu", "2", "memory", "2Gi"));

            tf.getSpec().getNamespaces().get(0).setResourceQuotas(quota);

            setupMocks();
            when(genericResource.get()).thenReturn(null);
            when(genericOperation.resource(any(GenericKubernetesResource.class))).thenReturn(genericResource);

            // When
            engine.triggerWorkflow(tf);

            // Then
            verify(genericOperation).resource(resourceCaptor.capture());
            GenericKubernetesResource app = resourceCaptor.getValue();

            @SuppressWarnings("unchecked")
            Map<String, Object> spec = (Map<String, Object>) app.getAdditionalProperties().get("spec");
            @SuppressWarnings("unchecked")
            Map<String, Object> source = (Map<String, Object>) spec.get("source");
            @SuppressWarnings("unchecked")
            Map<String, Object> helm = (Map<String, Object>) source.get("helm");
            String values = (String) helm.get("values");

            assertTrue(values.contains("resourceQuota:"));
            assertTrue(values.contains("pods: 10"));
            assertTrue(values.contains("cpu: 1"));
            assertTrue(values.contains("memory: 1Gi"));
        }
    }
